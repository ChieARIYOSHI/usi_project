{"ast":null,"code":"var _jsxFileName = \"/Users/qrec-pm/usi_project/src/components/shop.js\";\nimport React from 'react';\nimport { Link } from 'react-router-dom';\nimport firebase, { db } from '../firebase';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Shop extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      list: []\n    };\n\n    this.getData = async () => {\n      const colRef = db // .orderBy('createdAt', 'desc')\n      .limit(10);\n      const snapshots = await colRef.get();\n      const docs = snapshots.docs.map(doc => doc.data());\n      await this.setState({\n        list: docs\n      });\n      console.log(list);\n    };\n\n    this.onCollectionUpdate = querySnapshot => {\n      //変更の発生源を特定 local:自分, server:他人\n      // const source = querySnapshot.metadata.hasPendingWrites ? \"local\" : \"server\";\n      // if (source === 'local')  this.getData(); //期待した動きをしない\n      this.getData();\n    };\n\n    this.componentDidMount = async () => {\n      //普通に取得\n      await this.getData(); //collectionの更新を監視\n\n      this.unsubscribe = db.onSnapshot(this.onCollectionUpdate);\n    };\n\n    this.componentWillUnmount = () => {\n      this.unsubscribe();\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-center my-5\",\n        children: \"\\u5546\\u54C1\\u4E00\\u89A7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"table\",\n        children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: this.state.list.map(item => /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"farm\",\n              children: item.farm\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 55,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: item.product\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 56,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: [item.gram, \" \\u30B0\\u30E9\\u30E0\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 57,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: [item.price, \" \\u5186\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 58,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: item.detail\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 59,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(Link, {\n                to: \"/bought\",\n                children: \"\\u8CFC\\u5165\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 60,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 60,\n              columnNumber: 37\n            }, this)]\n          }, item.docId + String(new Date()), true, {\n            fileName: _jsxFileName,\n            lineNumber: 54,\n            columnNumber: 33\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 51,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default Shop;","map":{"version":3,"sources":["/Users/qrec-pm/usi_project/src/components/shop.js"],"names":["React","Link","firebase","db","Shop","Component","state","list","getData","colRef","limit","snapshots","get","docs","map","doc","data","setState","console","log","onCollectionUpdate","querySnapshot","componentDidMount","unsubscribe","onSnapshot","componentWillUnmount","render","item","farm","product","gram","price","detail","docId","String","Date"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,IAAT,QAAqB,kBAArB;AAEA,OAAOC,QAAP,IAAmBC,EAAnB,QAA6B,aAA7B;;;AAEA,MAAMC,IAAN,SAAmBJ,KAAK,CAACK,SAAzB,CAAmC;AAAA;AAAA;AAAA,SAE/BC,KAF+B,GAEvB;AACJC,MAAAA,IAAI,EAAE;AADF,KAFuB;;AAAA,SAQ/BC,OAR+B,GAQrB,YAAY;AAClB,YAAMC,MAAM,GAAGN,EAAE,CACjB;AADiB,OAEhBO,KAFc,CAER,EAFQ,CAAf;AAGA,YAAMC,SAAS,GAAG,MAAMF,MAAM,CAACG,GAAP,EAAxB;AACA,YAAMC,IAAI,GAAGF,SAAS,CAACE,IAAV,CAAeC,GAAf,CAAmBC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EAA1B,CAAb;AACA,YAAM,KAAKC,QAAL,CAAc;AAChBV,QAAAA,IAAI,EAAEM;AADU,OAAd,CAAN;AAGAK,MAAAA,OAAO,CAACC,GAAR,CAAYZ,IAAZ;AACH,KAlB8B;;AAAA,SAqB/Ba,kBArB+B,GAqBTC,aAAD,IAAmB;AACpC;AACA;AACA;AACA,WAAKb,OAAL;AACH,KA1B8B;;AAAA,SA4B/Bc,iBA5B+B,GA4BX,YAAY;AAC5B;AACA,YAAM,KAAKd,OAAL,EAAN,CAF4B,CAG5B;;AACA,WAAKe,WAAL,GAAmBpB,EAAE,CAACqB,UAAH,CAAc,KAAKJ,kBAAnB,CAAnB;AACH,KAjC8B;;AAAA,SAoC/BK,oBApC+B,GAoCR,MAAM;AACzB,WAAKF,WAAL;AACH,KAtC8B;AAAA;;AAwC/BG,EAAAA,MAAM,GAAG;AACL,wBACI;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA,8BACI;AAAI,QAAA,SAAS,EAAC,kBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,eAEI;AAAO,QAAA,SAAS,EAAC,OAAjB;AAAA,+BACI;AAAA,oBAEQ,KAAKpB,KAAL,CAAWC,IAAX,CAAgBO,GAAhB,CAAoBa,IAAI,iBACpB;AAAA,oCACI;AAAI,cAAA,SAAS,EAAC,MAAd;AAAA,wBAAsBA,IAAI,CAACC;AAA3B;AAAA;AAAA;AAAA;AAAA,oBADJ,eAEI;AAAA,wBAAKD,IAAI,CAACE;AAAV;AAAA;AAAA;AAAA;AAAA,oBAFJ,eAGI;AAAA,yBAAKF,IAAI,CAACG,IAAV;AAAA;AAAA;AAAA;AAAA;AAAA,oBAHJ,eAII;AAAA,yBAAKH,IAAI,CAACI,KAAV;AAAA;AAAA;AAAA;AAAA;AAAA,oBAJJ,eAKI;AAAA,wBAAKJ,IAAI,CAACK;AAAV;AAAA;AAAA;AAAA;AAAA,oBALJ,eAMI;AAAA,qCAAI,QAAC,IAAD;AAAM,gBAAA,EAAE,EAAC,SAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAJ;AAAA;AAAA;AAAA;AAAA,oBANJ;AAAA,aAASL,IAAI,CAACM,KAAL,GAAaC,MAAM,CAAC,IAAIC,IAAJ,EAAD,CAA5B;AAAA;AAAA;AAAA;AAAA,kBADJ;AAFR;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,cAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,YADJ;AAqBH;;AA9D8B;;AAiEnC,eAAe/B,IAAf","sourcesContent":["import React from 'react';\nimport { Link } from 'react-router-dom';\n\nimport firebase, { db } from '../firebase';\n\nclass Shop extends React.Component {\n\n    state = {\n        list: [],\n    }\n\n    \n    //データ取得\n    getData = async () => {\n        const colRef = db\n        // .orderBy('createdAt', 'desc')\n        .limit(10);\n        const snapshots = await colRef.get();\n        const docs = snapshots.docs.map(doc => doc.data());\n        await this.setState({\n            list: docs,\n        });\n        console.log(list);\n    }\n\n    //更新時のcalback\n    onCollectionUpdate = (querySnapshot) => {\n        //変更の発生源を特定 local:自分, server:他人\n        // const source = querySnapshot.metadata.hasPendingWrites ? \"local\" : \"server\";\n        // if (source === 'local')  this.getData(); //期待した動きをしない\n        this.getData();\n    }\n\n    componentDidMount = async () => {\n        //普通に取得\n        await this.getData();\n        //collectionの更新を監視\n        this.unsubscribe = db.onSnapshot(this.onCollectionUpdate);\n    }\n\n    //監視解除\n    componentWillUnmount = () => {\n        this.unsubscribe();\n    }\n\n    render() {\n        return (\n            <div className=\"container\">\n                <h3 className=\"text-center my-5\">商品一覧</h3>\n                <table className=\"table\">\n                    <tbody>\n                        {\n                            this.state.list.map(item => (\n                                <tr key={item.docId + String(new Date())}>\n                                    <td className=\"farm\">{item.farm}</td>\n                                    <td>{item.product}</td>\n                                    <td>{item.gram} グラム</td>\n                                    <td>{item.price} 円</td>\n                                    <td>{item.detail}</td>\n                                    <td><Link to=\"/bought\">購入</Link></td>\n                                </tr>\n                            ))\n                        }\n                    </tbody>\n                </table>\n            </div>\n        );\n    }\n}\n\nexport default Shop;"]},"metadata":{},"sourceType":"module"}